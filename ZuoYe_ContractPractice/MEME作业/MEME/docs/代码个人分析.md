# 业务逻辑
1、每次转账收取一定费用到当前合约  
2、每次转账前都会判断当前合约里的费用是否到了可以添加流动性  
3、添加流动性时，将合约里的费用分给流动性、营销、销毁。  
    a、这些费用中去掉流动性和销毁的，全部转为ETH,转为ETH后，去掉给流动性的，全部转给营销钱包。  
    b、 再将流动性的ETH和代币添加到流动性中。如果有剩余，又转给了合约。  

# 属性
## 核心配置与地址 (Addresses & Key Constants)
|属性名称|类型|作用|备注|
|----------|--------|--------|--------|
|owner|address|合约所有者地址。 拥有管理权限（例如设置税率、开关交换）。|最高权限，控制合约的关键配置。|
|uniswapV2Routeraddress|DEX 路由合约地址（如 PancakeSwap 或 Uniswap V2 Router）。|用于执行代币交换 (SMEME→ETH) 和添加流动性。|
|marketingWallet|address|接收营销费用的钱包地址。|项目方的资金接收地址。|
|deadAddress|address|销毁地址（通常是 0x00...dead）。|用于接收销毁费用的 SMEME 代币。|
|WETH|address|WETH (Wrapped ETH) 地址。|用于 Uniswap 路径，作为 SMEME 转换为 ETH 的中间或目标代币。|

## 税费机制配置 (Fee Rates)

|属性名称|类型|作用|备注|
|------------------|--------|--------|--------|
|liquidityFee|uint256|流动性费用税率。 用于生成 LP Token。|50% 转换为 ETH， 50% 预留 SMEME。|
|marketingFee|uint256|营销费用税率。 转换为 ETH 并发送给 marketingWallet。|为项目运营提供资金。|
|burnFee|uint256|销毁费用税率。 发送到 deadAddress。|减少代币流通量。|
|reflectionFee|uint256|反射奖励费用税率。 用于给持币者分配奖励。|通过 r/t 机制增加余额。|
|totalFees|uint256|总税率（买入/卖出）。|上述所有税率的总和。|

## 流动性管理状态 (Liquidity Management Status)

|属性名称|类型|作用|备注|
|------------------|--------|--------|--------|
|swapEnabled|bool|交换和流动性添加功能的主开关。|决定是否执行 _swapAndLiquify 流程。|
|inSwap|bool|重入保护标志。|当 _swapAndLiquify 执行时设为 true，防止在 SMEME 代币与 ETH 交换时再次触发自身，导致交易失败。|
|swapThreshold|uint256|触发自动流动性添加的代币余额阈值。|当合约地址中的 SMEME 余额达到此数量时，触发 _swapAndLiquify。|
|automatedMarketMakerPairs|mapping(address => bool)|自动做市商对地址的映射。|用于识别和排除 DEX 池地址，确保在交易池子之间不收税费，或控制在与池子交易时只收取买入/卖出税。|

## 税务豁免 (Fee Exclusions)
|属性名称|类型|作用|备注|
|------------|--------|--------|--------|
|isExcludedFromFees|mapping(address => bool)|豁免地址的列表。|通常用于将 owner、marketingWallet 和 uniswapV2Router 地址排除在税费之外，防止内部操作被收税。|

# 方法
## 标准 ERC-20 和核心操作
|方法名称|用途|备注
|-----|----|----|
|constructor|部署和初始化合约。 设置初始代币发行量、部署者（Owner）、路由地址（Uniswap Router）、流动性钱包地址等初始变量。|在合约创建时执行一次。|
|"transfer(address to, uint256 amount)"|将代币从调用者地址转账给另一个地址。 这是最基本的转账功能。|触发合约内部的 _transfer 逻辑，可能会收取税费。|
|"transferFrom(address from, address to, uint256 amount)"|代表授权者，将代币从 from 地址转账给 to 地址。 通常用于 DEX 交易和 Staking 合约。|必须事先通过 approve 获得授权。同样可能会收取税费。|
|"approve(address spender, uint256 amount)"|授权 另一个地址（spender）可以代表调用者使用一定数量的代币。|是 transferFrom 的前置操作。|


## 税费和自动流动性机制
|方法名称|用途|备注|
|-----|----|----|
|"_transfer(address from, address to, uint256 amount)"|（内部函数）代币转账的底层实现。 负责检查交易类型、计算并收取税费、更新余额、检查是否达到 swapThreshold。|是合约的核心业务逻辑，由 transfer 和 transferFrom 调用。|
|_swapAndLiquify(uint256 contractTokenBalance)|（内部函数）执行自动流动性添加和营销费用分配。|在 _transfer 函数中，当余额达到阈值时触发。|
|"addLiquidity(uint256 tokenAmount, uint256 ethAmount)"|（可能存在）手动或内部调用，将 SMEME 代币和 ETH 添加到流动性池中。|核心逻辑在 _swapAndLiquify 流程中被调用。|


## 管理和配置功能（仅限 Owner 调用）
|方法名称|用途|备注|
|------|----|----|
|setSwapAndLiquifyEnabled(bool _enabled)|开启或关闭 自动流动性/营销费用的处理机制。|允许项目方暂停或恢复自动费用处理。|
|setSwapThreshold(uint256 _swapThreshold)|设置 触发 _swapAndLiquify 的代币余额阈值。|用于调整自动卖出代币的频率和规模。|
|setMarketingWallet(address _marketingWallet)|更改 接收营销费用的目标钱包地址。|允许项目方更换资金接收地址。|
|setFeeRates(...)|设置 所有的买入、卖出和转账税率（例如 liquidityFee、marketingFee、burnFee 等）。|核心配置功能，用于调整代币经济模型。|
|"excludeFromFees(address account, bool excluded)" |将特定地址排除在税费之外。 通常用于排除 Owner 地址、DEX 路由地址和流动性钱包。|确保合约内部操作不会因税费而失败。|
|emergencyWithdrawETH()|紧急提取合约地址中残留的 ETH 余额。|您提到的方法。用于提取意外留下的 ETH 零头。|

## 查询功能（View/Pure Functions）

|方法名称|用途|备注|
|-----|----|----|
|balanceOf(address account)|查询 某个地址持有的代币数量。|标准 ERC-20 函数。|
|"allowance(address owner, address spender)"|查询 某个地址已授权给另一个地址可使用的代币数量。|标准 ERC-20 函数。|
|totalSupply()|查询 代币的总发行量。|标准 ERC-20 函数。|
|getOwner()|查询 合约当前所有者的地址。|常见于继承自 OpenZeppelin Ownable 的合约。|
|getSwapThreshold()|查询 当前设定的交换阈值。|用于审计和前端展示。|